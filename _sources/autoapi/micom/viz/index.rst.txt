:mod:`micom.viz`
================

.. py:module:: micom.viz

.. autoapi-nested-parse::

   Init file for MICOM Visualization.



Submodules
----------
.. toctree::
   :titlesonly:
   :maxdepth: 1

   core/index.rst
   exchanges/index.rst
   growth/index.rst
   prediction/index.rst
   tradeoff/index.rst


Package Contents
----------------

Classes
~~~~~~~

.. autoapisummary::

   micom.viz.Visualization



Functions
~~~~~~~~~

.. autoapisummary::

   micom.viz.plot_exchanges_per_sample
   micom.viz.plot_exchanges_per_taxon
   micom.viz.plot_growth
   micom.viz.plot_fit
   micom.viz.plot_tradeoff



.. class:: Visualization(filename, data, template)


   Bases: :py:obj:`object`

   A visualization object.

   .. attribute:: filename

      The filename of trhe saved visualization.

      :type: str

   .. attribute:: data

      The data used to create the Visualization.

      :type: dict

   .. attribute:: template

      The jinja template used to render the visualization.

      :type: jinja2.Template

   .. method:: view(self)

      Open the visualization in a browser.

      :param None.:

      :returns:
      :rtype: nothing


   .. method:: save(self, **kwargs)

      Render and and save the visualization.



.. function:: plot_exchanges_per_sample(results, filename='sample_exchanges_%s.html' % datetime.now().strftime('%Y%m%d'), direction='import', cluster=True) -> None

   Plot the per sample exchange fluxes.

   :param results: The results returned by the `grow` workflow.
   :type results: micom.workflows.GrowthResults
   :param filename: The HTML file where the visualization will be saved.
   :type filename: str
   :param direction: The direction of fluxes to plot.
   :type direction: str either "import" or "export"
   :param cluster: Whether to reorder samples so that samples with similar exchange
                   fluxes are close to another.
   :type cluster: bool

   :returns: A MICOM visualization. Can be served with `viz.serve`.
   :rtype: Visualization


.. function:: plot_exchanges_per_taxon(results, filename='taxon_exchanges_%s.html' % datetime.now().strftime('%Y%m%d'), direction='import', use_total_flux=False, **tsne_args) -> None

   Plot the exchange fluxes per taxon.

   :param results: The exchanges returned by the `grow` workflow.
   :type results: micom.workflows.GrowthResults
   :param filename: The HTML file where the visualization will be saved.
   :type filename: str
   :param direction: The direction of fluxes to plot.
   :type direction: str either "import" or "export"
   :param use_total_fluxes: Whether to use fluxes normalized to 1gDW of bacteria or the total flux.
   :type use_total_fluxes: bool
   :param tsne_args: Additional arguments passed to TSNE.
   :type tsne_args: dict

   :returns: A MICOM visualization. Can be served with `viz.serve`.
   :rtype: Visualization


.. function:: plot_growth(results, filename='growth_rates_%s.html' % datetime.now().strftime('%Y%m%d'), tolerance=1e-06)

   Plot the taxa growth rates.

   :param results: The results returned by the `grow` workflow.
   :type results: micom.workflows.GrowthResults
   :param filename: The HTML file where the visualization will be saved.
   :type filename: str
   :param tolerance: Smallest growth rate that will be considered. Everything lower will be
                     considered not growing.
   :type tolerance: float

   :returns: A MICOM visualization. Can be served with `viz.serve`.
   :rtype: Visualization


.. function:: plot_fit(results, phenotype, variable_type='binary', variable_name='phenotype', filename='fit_%s.html' % datetime.now().strftime('%Y%m%d'), flux_type='production', min_coef=0.001, atol=1e-06)

   Test for differential metabolite production.

   This will fit the `phenotype` response using L1-regularized linear models
   with log-fluxes as features. Will use LASSO regression for a continuous
   response and L1-regularized Logistic regression for a binary response.

   :param results: The results returned by the `grow` workflow.
   :type results: micom.workflows.GrowthResults
   :param phenotype: The data to be fitted. Its index must correspond to `sample_id` in
                     `exchanges`.
   :type phenotype: pandas.Series
   :param variable_type: The type of the variable.
   :type variable_type: str of ["binary", "continuous"]
   :param variable_name: A short description of the phenotype for instance "disease_status".
   :type variable_name: str
   :param filename: The HTML file where the visualization will be saved.
   :type filename: str
   :param flux_type: Whether to fit using import or production fluxes.
   :type flux_type: str of ["import", "production"]
   :param min_coef: Only report coefficient that are at least that large.
   :type min_coef: float in [0.0, Inf]
   :param atol: Tolerance to consider a flux different from zero. Should be roughly equivalent
                to the solver tolerance.
   :type atol: float

   :returns: A MICOM visualization. Can be served with `viz.view`.
   :rtype: Visualization


.. function:: plot_tradeoff(tradeoff_rates, filename='tradeoff_%s.html' % datetime.now().strftime('%Y%m%d'), tolerance=1e-06)

   Plot diagnostics for varying tradeoff values.

   :param tradeoff_rates: The growth rates returned by the `tradeoff` workflow.
   :type tradeoff_rates: pandas.DataFrame
   :param filename: The HTML file where the visualization will be saved.
   :type filename: str
   :param tolerance: Smallest growth rate that will be considered. Everything lower will be
                     considered not growing.
   :type tolerance: float

   :returns: A MICOM visualization. Can be served with `viz.serve`.
   :rtype: Visualization


