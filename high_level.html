
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MICOM workflows &#8212; version 0.22.7</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualizations" href="viz.html" />
    <link rel="prev" title="Installing micom" href="installing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/micom.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">version 0.22.7</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="logic.html">
   Methods used by MICOM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="installing.html">
   Installing MICOM
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   MICOM workflows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="viz.html">
   Visualizations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="workflows.html">
   Writing your own workflows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="community.html">
   Single Model API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="growth_fluxes.html">
   Growth rates and fluxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="media.html">
   Growth media
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taxa_knockouts.html">
   Knockouts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elasticities.html">
   Intervention studies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorials.html">
   Tutorials and Courses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NEWS.html">
   Release Notes
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="autoapi/index.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="autoapi/micom/index.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       micom
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/data/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.data
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="autoapi/micom/viz/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.viz
        </span>
       </code>
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/viz/core/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.viz.core
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/viz/exchanges/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.viz.exchanges
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/viz/growth/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.viz.growth
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/viz/prediction/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.viz.prediction
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/viz/tradeoff/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.viz.tradeoff
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="autoapi/micom/workflows/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.workflows
        </span>
       </code>
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/workflows/build/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.workflows.build
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/workflows/core/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.workflows.core
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/workflows/db_media/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.workflows.db_media
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/workflows/grow/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.workflows.grow
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/workflows/media/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.workflows.media
          </span>
         </code>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="autoapi/micom/workflows/tradeoff/index.html">
         <code class="xref py py-mod docutils literal notranslate">
          <span class="pre">
           micom.workflows.tradeoff
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/algorithms/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.algorithms
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/annotation/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.annotation
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/community/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.community
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/db/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.db
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/deps/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.deps
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/duality/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.duality
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/elasticity/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.elasticity
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/logger/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.logger
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/media/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.media
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/optcom/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.optcom
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/problems/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.problems
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/qiime_formats/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.qiime_formats
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/solution/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.solution
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/taxonomy/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.taxonomy
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="autoapi/micom/util/index.html">
       <code class="xref py py-mod docutils literal notranslate">
        <span class="pre">
         micom.util
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/high_level.ipynb.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Building-and-models-and-simulating-growth">
   Building and models and simulating growth
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Input-formats">
     Input formats
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Building-community-models">
     Building community models
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Simulating-growth">
     Simulating growth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Choosing-a-tradeoff-parameter">
     Choosing a tradeoff parameter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Fixing-growth-media">
     Fixing growth media
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="MICOM-workflows">
<h1>MICOM workflows<a class="headerlink" href="#MICOM-workflows" title="Permalink to this headline">¶</a></h1>
<p>The MICOM workflow API provides prebuilt solutions for the most common MICOM analyses across several samples. This will manage most of the workload for you and uses an efficient parallelization scheme to make use of several CPU cores. The workflow API is probably the best entry point for you if the following is true:</p>
<ol class="arabic simple">
<li><p>You have at least 2 samples with taxonomy assignments and abundances for each</p></li>
<li><p>You have chosen to use one of the preused model databases or have already built your own</p></li>
<li><p>You want to run a set of standard analyses and visualization on the models</p></li>
</ol>
<p>In that case the prebuilt workflows will make your analysis much simpler and faster and will take care of parallelizing your analyses. The worflow API can be mixed with the MICOM API at any point. So you could do a few steps with the workflows and then run you own analyses downstream from that. Additionally, you can directly import you start data from Qiime 2. See the <a class="reference external" href="qiime2.html">Loading Qiime 2 data</a>.</p>
<div class="section" id="Building-and-models-and-simulating-growth">
<h2>Building and models and simulating growth<a class="headerlink" href="#Building-and-models-and-simulating-growth" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Input-formats">
<h3>Input formats<a class="headerlink" href="#Input-formats" title="Permalink to this headline">¶</a></h3>
<p>To start building community models for all your samples you will need to provide your data to MICOM. MICOM prefers to have the taxonomy and abundances for all samples in a single <a class="reference external" href="https://vita.had.co.nz/papers/tidy-data.pdf">tidy DataFrame</a>. Here each taxon in each sample is a row which provides its taxonomy and abundance. This may sound a bit confusing but should become pretty clear when looking at an example. MICOM can generate a simple example DataFrame which we can use as guidance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom.data import test_data

data = test_data()
data
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>genus</th>
      <th>species</th>
      <th>reactions</th>
      <th>metabolites</th>
      <th>file</th>
      <th>sample_id</th>
      <th>abundance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Escherichia_coli_1</td>
      <td>Escherichia</td>
      <td>Escherichia coli 0</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_1</td>
      <td>882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Escherichia_coli_2</td>
      <td>Escherichia</td>
      <td>Escherichia coli 1</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_1</td>
      <td>718</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Escherichia_coli_3</td>
      <td>Escherichia</td>
      <td>Escherichia coli 2</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_1</td>
      <td>817</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Escherichia_coli_4</td>
      <td>Escherichia</td>
      <td>Escherichia coli 3</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_1</td>
      <td>850</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Escherichia_coli_1</td>
      <td>Escherichia</td>
      <td>Escherichia coli 0</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_2</td>
      <td>423</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Escherichia_coli_2</td>
      <td>Escherichia</td>
      <td>Escherichia coli 1</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_2</td>
      <td>765</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Escherichia_coli_3</td>
      <td>Escherichia</td>
      <td>Escherichia coli 2</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_2</td>
      <td>694</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Escherichia_coli_4</td>
      <td>Escherichia</td>
      <td>Escherichia coli 3</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_2</td>
      <td>129</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Escherichia_coli_1</td>
      <td>Escherichia</td>
      <td>Escherichia coli 0</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_3</td>
      <td>823</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Escherichia_coli_2</td>
      <td>Escherichia</td>
      <td>Escherichia coli 1</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_3</td>
      <td>110</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Escherichia_coli_3</td>
      <td>Escherichia</td>
      <td>Escherichia coli 2</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_3</td>
      <td>260</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Escherichia_coli_4</td>
      <td>Escherichia</td>
      <td>Escherichia coli 3</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_3</td>
      <td>807</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Escherichia_coli_1</td>
      <td>Escherichia</td>
      <td>Escherichia coli 0</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_4</td>
      <td>436</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Escherichia_coli_2</td>
      <td>Escherichia</td>
      <td>Escherichia coli 1</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_4</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Escherichia_coli_3</td>
      <td>Escherichia</td>
      <td>Escherichia coli 2</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_4</td>
      <td>631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Escherichia_coli_4</td>
      <td>Escherichia</td>
      <td>Escherichia coli 3</td>
      <td>95</td>
      <td>72</td>
      <td>/home/cdiener/code/micom/micom/data/e_coli_cor...</td>
      <td>sample_4</td>
      <td>479</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This is very simple example where each sample contains 4 different <em>E. coli</em> species in random abundances. Thus, every sample has 4 rows in this DataFrame. The DataFrame also contains additional columns, <strong>the only required columns are “id”, “sample_id”, “abundance” and one column that provides the summary rank, here “species”.</strong></p>
<p>Note that we also have an additional column “genus” here. The minimal taxonomic information you have to provide is only the name of the taxonomy rank matching the database you are using. So if you are using a genus-level database you will need a column “genus”. In this case we mill use a species-level database so we had to provide a column “species”. If there any additional columns from the set <code class="docutils literal notranslate"><span class="pre">{&quot;kingdom&quot;,</span> <span class="pre">&quot;phylum&quot;,</span> <span class="pre">&quot;class&quot;,</span> <span class="pre">&quot;order&quot;,</span> <span class="pre">&quot;family&quot;,</span> <span class="pre">&quot;genus&quot;,</span> <span class="pre">&quot;species&quot;}</span></code> those will be used to make
the mapping with the database more stringent. For instance, here we provided a column “genus” which means models will only be counted as a “match” if the taxon has the same genus <em>and</em> species in the data and the model database.</p>
<p>Thus, the more taxonomic rank columns you include in the data you pass to MICOM, the more stringent MICOM will become matching to the reference database. This can be used to circumvent poorly matching ranks as well. For instance, if you know your data matches well by genus and phylum names but families are named differently even for the same taxa you can omit the “family” column from your data.</p>
</div>
<div class="section" id="Building-community-models">
<h3>Building community models<a class="headerlink" href="#Building-community-models" title="Permalink to this headline">¶</a></h3>
<p>To build a community sample for each of your sample you will need the abundance table as provided above and a model database. Usually we recommend to use one of the prebuilt MICOM database from <a class="reference external" href="https://doi.org/10.5281/zenodo.3755182">https://doi.org/10.5281/zenodo.3755182</a>. Additionally, you can also <a href="#id1"><span class="problematic" id="id2">`create your own database &lt;&gt;`__</span></a>.</p>
<p>For our example we have a custom species-level database that is bundled with MICOM. With the abundance table and database you can now start building your models by providing a folder where the assembled community models should be stored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom.data import test_db
from micom.workflows import build

manifest = build(data, out_folder=&quot;models&quot;, model_db=test_db, cutoff=0.0001, threads=2)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5636900736ac45b9b8a9e9ca7f9272e3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>This will also allow you to specify a relative abundance cutoff for a taxon to be included with the <code class="docutils literal notranslate"><span class="pre">cutoff</span></code> argument. The default is to include only taxa that constitute at least 0.01% of the sample. Model building will be automatically parallelized over multiple CPUs and the number of cores/threads to use for should be set with the <code class="docutils literal notranslate"><span class="pre">threads</span></code> argument. The workflows will also warn you if for any samples less than 50% of the abundance was matched to the database. Since our data was random
this may have happened here.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">build</span></code> workflow will return a model manifest:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>manifest
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>reactions</th>
      <th>metabolites</th>
      <th>file</th>
      <th>sample_id</th>
      <th>found_taxa</th>
      <th>total_taxa</th>
      <th>found_fraction</th>
      <th>found_abundance_fraction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>95</td>
      <td>72</td>
      <td>sample_1.pickle</td>
      <td>sample_1</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.75</td>
      <td>0.730028</td>
    </tr>
    <tr>
      <th>1</th>
      <td>95</td>
      <td>72</td>
      <td>sample_2.pickle</td>
      <td>sample_2</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.75</td>
      <td>0.789657</td>
    </tr>
    <tr>
      <th>2</th>
      <td>95</td>
      <td>72</td>
      <td>sample_3.pickle</td>
      <td>sample_3</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.75</td>
      <td>0.588500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>95</td>
      <td>72</td>
      <td>sample_4.pickle</td>
      <td>sample_4</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.75</td>
      <td>0.728856</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This will propagate information from your input table as well as give you metrics on how well the samples were matched to the database. Our database only include models for the first 3 <em>E. coli</em> species so you see the workflow could only match 3/4 taxa for each sample. Probably the most important column is the <code class="docutils literal notranslate"><span class="pre">found_abundance_fraction</span></code>. This one tells which fraction of the sample abundance was matched to the database. You usually want this column to be above 0.5 so the majority of the sample
is matched. A value of 1.0 would be perfect but is usually hard to achieve. Values around 0.8 are usually pretty good.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> column denotes the filename for the built community within the folder specified as <code class="docutils literal notranslate"><span class="pre">out_folder</span></code> before. You can use the <code class="docutils literal notranslate"><span class="pre">load_pickle</span></code> function to read individual models and run custom analyses.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom import load_pickle

com = load_pickle(&quot;models/sample_1.pickle&quot;)
print(len(com.reactions))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
305
</pre></div></div>
</div>
</div>
<div class="section" id="Simulating-growth">
<h3>Simulating growth<a class="headerlink" href="#Simulating-growth" title="Permalink to this headline">¶</a></h3>
<p>With our built models we can now advance to simulating growth with MICOMs <code class="docutils literal notranslate"><span class="pre">cooperative</span> <span class="pre">tradeoff</span></code> algorithm. This will use the manifest we just generated but will also require a growth medium to be specified. A growth medium provided information which metabolites are available to the microbes for consumption and also provided an upper bound on the flux it is added to the system. This can be obtained from fluxomics data or approximated from growth media (for cultivation settings) or diet data
(for gut microbiota models). Obtaining a correct media composition can be challenging. We will show some helper functions for that later on but for now we will use a pres-specified medium saved in Qiime 2 format. We also provide a growth medium describing an average Western diet for the AGORA model database at <a class="reference external" href="https://doi.org/10.5281/zenodo.3755182">https://doi.org/10.5281/zenodo.3755182</a>.</p>
<p>Growth media in MICOM are pretty simple DataFrames and can be read from a variety of formats. Here we will use the Qiime 2 Artifact format.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom.data import test_medium
from micom.qiime_formats import load_qiime_medium

medium = load_qiime_medium(test_medium)
medium
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>reaction</th>
      <th>flux</th>
      <th>metabolite</th>
    </tr>
    <tr>
      <th>reaction</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>EX_glc__D_m</th>
      <td>EX_glc__D_m</td>
      <td>10.000000</td>
      <td>glc__D_m</td>
    </tr>
    <tr>
      <th>EX_nh4_m</th>
      <td>EX_nh4_m</td>
      <td>4.362240</td>
      <td>nh4_m</td>
    </tr>
    <tr>
      <th>EX_o2_m</th>
      <td>EX_o2_m</td>
      <td>18.579253</td>
      <td>o2_m</td>
    </tr>
    <tr>
      <th>EX_pi_m</th>
      <td>EX_pi_m</td>
      <td>2.942960</td>
      <td>pi_m</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As we can see a medium is simply a DataFrame with columns <code class="docutils literal notranslate"><span class="pre">reaction</span></code> and <code class="docutils literal notranslate"><span class="pre">flux</span></code>. Where reaction is the name of external exchange reaction in the model and flux is the upper bound (usually in mmol/gDW/h).</p>
<p>The last thing we need to choose is the <code class="docutils literal notranslate"><span class="pre">tradeoff</span></code> parameter for the growth simulation. This is explained in detail in the [Methods used by MICOM] section and expresses what fraction of maximum community growth is to be maintained while trying to maximize individual growth rates. The <code class="docutils literal notranslate"><span class="pre">tradeoff</span></code> takes values between 0 and 1 where zero denotes no community growth and and 1 denotes maximum community growth. We will use a vlue of 0.5 here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom.workflows import grow

res = grow(manifest, model_folder=&quot;models&quot;, medium=medium, tradeoff=0.5, threads=2)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "941f83ab524e4bef94ea445b930f356a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>This gives us a results tuple with three entries: <code class="docutils literal notranslate"><span class="pre">growth_rates</span></code>, <code class="docutils literal notranslate"><span class="pre">exchanges</span></code>, and <code class="docutils literal notranslate"><span class="pre">annotations</span></code> providing the growth rates, exchange fluxes and metabolite annotations, respectively. This could be passed on to the visualization workflows or you could run your own analyses on those DataFrames. But for now we will go back and look at some helper workflows to choose a tradeoff parameter and get media.</p>
</div>
<div class="section" id="Choosing-a-tradeoff-parameter">
<h3>Choosing a tradeoff parameter<a class="headerlink" href="#Choosing-a-tradeoff-parameter" title="Permalink to this headline">¶</a></h3>
<p>Results depend strongly on the tradeoff parameter. Even though values between 0.3-0.6 usually work well we recommend to run a tradeoff analysis to choose the best parameters for your data set and protocol. If you have already analyzed many samples in your lab and found a particular value to work well in general you may just use that but you should at least run this analysis once. In <a class="reference external" href="https://doi.org/10.1128/mSystems.00606-19">our paper</a> we found that tradeoff best reproducing <em>in vivo</em> growth
rates is the largest tradeoff that allows the majority of the bacteria to grow. Thus, the best tradeoff value is the value providing the best compromise between individual and cooperative growth.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tradeoff</span></code> workflow will run growth simulations with several tradeoff values and return the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom.workflows import tradeoff

tradeoff_rates = tradeoff(manifest, model_folder=&quot;models&quot;, medium=medium, threads=2)
tradeoff_rates.head()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2425d018188e4ef8b0772b4a7badd7c9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>abundance</th>
      <th>growth_rate</th>
      <th>reactions</th>
      <th>metabolites</th>
      <th>taxon</th>
      <th>tradeoff</th>
      <th>sample_id</th>
    </tr>
    <tr>
      <th>compartments</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Escherichia_coli_2</th>
      <td>0.301048</td>
      <td>0.000000</td>
      <td>95</td>
      <td>72</td>
      <td>Escherichia_coli_2</td>
      <td>NaN</td>
      <td>sample_1</td>
    </tr>
    <tr>
      <th>Escherichia_coli_3</th>
      <td>0.342558</td>
      <td>1.433863</td>
      <td>95</td>
      <td>72</td>
      <td>Escherichia_coli_3</td>
      <td>NaN</td>
      <td>sample_1</td>
    </tr>
    <tr>
      <th>Escherichia_coli_4</th>
      <td>0.356394</td>
      <td>0.866510</td>
      <td>95</td>
      <td>72</td>
      <td>Escherichia_coli_4</td>
      <td>NaN</td>
      <td>sample_1</td>
    </tr>
    <tr>
      <th>Escherichia_coli_2</th>
      <td>0.301048</td>
      <td>0.718937</td>
      <td>95</td>
      <td>72</td>
      <td>Escherichia_coli_2</td>
      <td>1.0</td>
      <td>sample_1</td>
    </tr>
    <tr>
      <th>Escherichia_coli_3</th>
      <td>0.342558</td>
      <td>0.818066</td>
      <td>95</td>
      <td>72</td>
      <td>Escherichia_coli_3</td>
      <td>1.0</td>
      <td>sample_1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As we see it returns growth rates for each taxon in each sample for various tradeoff values. There is also a tradeoff value of <code class="docutils literal notranslate"><span class="pre">NaN</span></code> which means optimization of the pure community growth rate without regularization which usually has very bad performance and is provided as a reference. To choose a good value we can count how many of the taxa can grow (growth rate &gt; 1e-6) on average for each of the tradeoff values across all samples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>tradeoff_rates.groupby(&quot;tradeoff&quot;).apply(
    lambda df: (df.growth_rate &gt; 1e-6).sum()).reset_index()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tradeoff</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.2</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.3</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.4</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.5</td>
      <td>12</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.6</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.8</td>
      <td>12</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.0</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In that case all taxa (3 taxa for 4 samples each) can grow for all tradeoff values since we provided an excess of nutrients in the medium. So a tradeoff of 1.0 would have been the best here. For real data you will usually see those numbers decline for larger tradeoff values. A more detailed analysis can be performed with the <code class="docutils literal notranslate"><span class="pre">`plot_tradeoff</span></code> visualization &lt;viz.html&gt;`__.</p>
</div>
<div class="section" id="Fixing-growth-media">
<h3>Fixing growth media<a class="headerlink" href="#Fixing-growth-media" title="Permalink to this headline">¶</a></h3>
<p>Providing a growth medium may be complicated since you often only have some intuitions about a few components of the medium but lack information on others. Even when supplying putatively complete descriptions you will often observe that the models will predict the absence of growth since you are lacking an essential cofactor. To help with this MICOM provides a workflow that can complete any predefined growth medium with the minimal additional substrates to allow growth for all taxa in the
database.</p>
<p>For instance let us assume we know that our <em>E. coli</em> samples consume Glucose and Oxygen. The respective exchange reactions are <code class="docutils literal notranslate"><span class="pre">EX_glc__D_m</span></code> and <code class="docutils literal notranslate"><span class="pre">EX_o2_m</span></code>. So we can start by building our candidate medium assuming we can import twice as much oxygen as glucose.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import pandas as pd

candidate_medium = pd.DataFrame({&quot;reaction&quot;: [&quot;EX_glc__D_m&quot;, &quot;EX_o2_m&quot;], &quot;flux&quot;: [10, 20]})
candidate_medium
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>reaction</th>
      <th>flux</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>EX_glc__D_m</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>EX_o2_m</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can now ask MICOM to complete this medium by adding the smallest amount of overall flux so that all taxa in the database can grow with a growth rate off at least 0.1 1/h.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from micom.workflows import fix_medium

medium = fix_medium(manifest, model_folder=&quot;models&quot;, medium=candidate_medium,
                    community_growth=0.1, min_growth=0.01,
                    max_import=10, threads=2)
medium
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "65a5e1aea1dc41ab9381a49c31dca619", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>reaction</th>
      <th>metabolite</th>
      <th>description</th>
      <th>flux</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>EX_glc__D_m</td>
      <td>glc__D_m</td>
      <td>D-Glucose</td>
      <td>10.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>EX_gln__L_m</td>
      <td>gln__L_m</td>
      <td>L-Glutamine</td>
      <td>0.27264</td>
    </tr>
    <tr>
      <th>2</th>
      <td>EX_o2_m</td>
      <td>o2_m</td>
      <td>O2</td>
      <td>20.00000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>EX_pi_m</td>
      <td>pi_m</td>
      <td>Phosphate</td>
      <td>0.36787</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>So we see that we can achieve growth by adding import for phosphate and glutamine.</p>
</div>
</div>
</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="installing.html" title="previous page">Installing micom</a>
    <a class='right-next' id="next-link" href="viz.html" title="next page">Visualizations</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Christian Diener<br/>
        
            &copy; Copyright 2017-2021, Christian Diener.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>